<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<script runat='server'> // DO NOT REMOVE: needed for the Jaxer unit testing harness 
			Jaxer.load(Jaxer.request.parsedUrl.queryParts.testHarnessHeader);
		</script>	
		<title>MySQL DB Tests</title>
		<script type='text/javascript' runat='server'>
			
			function SKIP_TESTS()
			{
				var isMySQL = Jaxer.Config.DEFAULT_DB.IMPLEMENTATION == "MySQL";
				return isMySQL ? null : "Not using MySQL for user database";
			}
			
			/**
			 * Utility method that drops a table.
			 * @param {String} tableName
			 *	The name of a table to drop
			 */
			function dropTable(tableName)
			{
				Jaxer.DB.execute("DROP TABLE IF EXISTS " + tableName);
			}
			
			/**
			 * Utility method that drops a table if exists and creates a new one.
			 * @param {String} tableName
			 * @param {String} type - DB row type
			 *	The name of a table to drop
			 */
			function initTable(tableName, typeOrTypes)
			{
				Jaxer.DB.execute("DROP TABLE IF EXISTS " + tableName);
				
				if (typeof typeOrTypes == "string") typeOrTypes = [typeOrTypes];
				var nameTypePairs = typeOrTypes.map(function(type, index) { return "value" + index + " " + type; });
				
				var createTestDBtable = 
					"CREATE TABLE IF NOT EXISTS " + tableName + " (" +
					nameTypePairs.join(", ") + 
					");"
			
				Jaxer.DB.execute(createTestDBtable);
			}
			
			/**
			 * Utility method that compares two dates taking into account that 
			 * MySQL stores time accurate within 1 second.
			 * @param {Date} gotDate - got date
			 * @param {String} expectedDate - expected date
			 *	The name of a table to drop
			 */
			function assertDatesEqual(gotDate, expectedDate, message)
			{
				if (expectedDate.getUTCFullYear() != gotDate.getUTCFullYear()
					|| expectedDate.getUTCMonth() != gotDate.getUTCMonth()
					|| expectedDate.getUTCDate() != gotDate.getUTCDate()
					|| expectedDate.getUTCHours() != gotDate.getUTCHours()
					|| expectedDate.getUTCMinutes() != gotDate.getUTCMinutes()
					|| (Math.abs(expectedDate.getUTCSeconds() - gotDate.getUTCSeconds()) > 1))
				{
					text = "Expected " + expectedDate + " but found " + gotDate;
					
					if (message)
					{	
						text += __eol() + message;
					}
					
					throw new Error(text);
				}	
			}
			
			/**
			 * Utility method that compares two dates only (ignoring time component).
			 * @param {Date} gotDate - got date
			 * @param {String} expectedDate - expected date
			 *	The name of a table to drop
			 */
			function assertDatesOnlyEqual(gotDate, expectedDate, message)
			{
				
				if (expectedDate.getUTCFullYear() != gotDate.getUTCFullYear()
					|| expectedDate.getUTCMonth() != gotDate.getUTCMonth()
					|| expectedDate.getUTCDate() != gotDate.getUTCDate())
				{
					text = "Expected " + expectedDate + " but found " + gotDate;
					
					if (message)
					{	
						text += __eol() + message;
					}
					
					throw new Error(text);
				}	
			}
			
			/**
			 * Utility method that compares two dates taking into account that 
			 * MySQL stores time accurate within 1 second.
			 * @param {Date} gotDate - got date
			 * @param {String} expectedDate - expected date
			 *	The name of a table to drop
			 */
			function assertTimesOnlyEqual(gotDate, expectedDate, message)
			{
				var expectedTime = [expectedDate.getUTCHours(), expectedDate.getUTCMinutes(), expectedDate.getUTCSeconds()];
				var gotTime = [gotDate.getUTCHours(), gotDate.getUTCMinutes(), gotDate.getUTCSeconds()];
				if (expectedTime[0] != gotTime[0]
					|| expectedTime[1] != gotTime[1]
					|| (Math.abs(expectedTime[2] - gotTime[2]) > 1))
				{
					text = "Expected " + expectedTime + " but found " + gotTime;
					
					if (message)
					{	
						text += __eol() + message;
					}
					
					throw new Error(text);
				}	
			}
			
			/**
			 * Creates test date object.
			 */
			function createTestDate()
			{
				var toReturn = new Date(); 
				toReturn.setUTCFullYear(2010); 
				toReturn.setUTCMonth(0);
				toReturn.setUTCDate(14);
				toReturn.setUTCHours(6); 
				toReturn.setUTCMinutes(7); 
				toReturn.setUTCSeconds(8);
				toReturn.setUTCMilliseconds(500);
				
				return toReturn;
			}
			
			/**
			 * Creates date object from a string having the following format: "yyyy-mm-dd hh:mm:ss"
			 * @param {Object} dateString
			 */
			function dateFromString(dateString)
			{
				var year = parseInt(dateString.substring(0,4));
				var month = parseInt(dateString.substring(5,7));
				var day = parseInt(dateString.substring(8,10));
				var hours = parseInt(dateString.substring(11,13));
				var minutes = parseInt(dateString.substring(14,16));
				var seconds = parseInt(dateString.substring(17,19));
				var toReturn = new Date();
				toReturn.setUTCFullYear(year,month - 1,day); 
				toReturn.setUTCHours(hours); 
				toReturn.setUTCMinutes(minutes); 
				toReturn.setUTCSeconds(seconds);
				
				return toReturn;
			}
			
			function testInsertStringToTEXT()
			{			
				//creating DB table
				initTable("testStringToTEXTInsertTable", "TEXT");
				
				//inserting record
				var toInsert = "Test string";
				Jaxer.DB.execute("INSERT INTO testStringToTEXTInsertTable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testStringToTEXTInsertTable " +
					"WHERE value0='Test string'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testStringToTEXTInsertTable");
			}
			
			function testInsertStringToTEXTWithoutRequestParameters()
			{			
				//creating DB table
				initTable("testStringToTEXTInsertTable", "TEXT");
				
				//inserting record
				var toInsert = "Test string";
				Jaxer.DB.execute("INSERT INTO testStringToTEXTInsertTable (value0) VALUES ('Test string')");
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testStringToTEXTInsertTable " +
					"WHERE value0='Test string'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testStringToTEXTInsertTable");
			}
			
			function testInsertStringToVARCHAR()
			{			
				//creating DB table
				initTable("testStringToVARCHARInsertTable", "VARCHAR(20)");
				
				//inserting record
				var toInsert = "Test string";
				Jaxer.DB.execute("INSERT INTO testStringToVARCHARInsertTable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testStringToVARCHARInsertTable " +
					"WHERE value0='Test string'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testStringToVARCHARInsertTable");
			}
			
			function testInsertStringToCHARSET1()
			{			
				//creating DB table
				initTable("testStringToCHARSET1InsertTable", "TEXT CHARACTER SET latin1");
				
				//inserting record
				var toInsert = "Test string";
				Jaxer.DB.execute("INSERT INTO testStringToCHARSET1InsertTable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testStringToCHARSET1InsertTable " +
					"WHERE value0='Test string'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testStringToCHARSET1InsertTable");
			}
			
			function testInsertStringToCHARSET2()
			{			
				//creating DB table
				initTable("testStringToCHARSET2InsertTable", "TEXT CHARACTER SET utf8");
				
				//inserting record
				var toInsert = "Test string";
				Jaxer.DB.execute("INSERT INTO testStringToCHARSET2InsertTable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testStringToCHARSET2InsertTable " +
					"WHERE value0='Test string'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testStringToCHARSET2InsertTable");
			}
			
			function testInsertStringToLONGTEXT()
			{			
				//creating DB table
				initTable("testStringToLONGTEXTInsertTable", "LONGTEXT");
				
				//inserting record
				var toInsert = "Test string";
				Jaxer.DB.execute("INSERT INTO testStringToLONGTEXTInsertTable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testStringToLONGTEXTInsertTable " +
					"WHERE value0='Test string'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testStringToLONGTEXTInsertTable");
			}
			
			function testInsertStringToINTEGER()
			{			
				//creating DB table
				initTable("testStringToINTEGERInsertTable", "INTEGER");
				
				//inserting record
				var toInsert = "12";
				Jaxer.DB.execute("INSERT INTO testStringToINTEGERInsertTable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testStringToINTEGERInsertTable " +
					"WHERE value0='12'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testStringToINTEGERInsertTable");
			}
			
			function testInsertStringToDOUBLE()
			{			
				//creating DB table
				initTable("testStringToDOUBLEInsertTable", "DOUBLE");
			
				//inserting record
				var toInsert = "17.5";
				Jaxer.DB.execute("INSERT INTO testStringToDOUBLEInsertTable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testStringToDOUBLEInsertTable " +
					"WHERE value0='17.5'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testStringToDOUBLEInsertTable");
			}
			
			// Not something we really need to test for:
//			function testInsertStringToBLOB()
//			{			
//				//creating DB table
//				initTable("testStringToBLOBInsertTable", "BLOB");
//			
//				//inserting record
//				var toInsert = "Test string";
//				Jaxer.DB.execute("INSERT INTO testStringToBLOBInsertTable (value0) VALUES (?)",[toInsert]);
//				
//				//checking that the value is written to the table
//				result = 
//					Jaxer.DB.execute("SELECT count(*) AS c FROM testStringToBLOBInsertTable").singleResult;
//				assertTrue(result == 1, "We should have a record containing inserted value");
//				
//				//dropping the table
//				dropTable("testStringToBLOBInsertTable");
//			}
			
			function testInsertUnicodeString()
            {			
				//creating DB table
				var sTable = "testUnicodeStringInsertTable";
            	initTable(sTable, "VARCHAR(40) character set utf8");
				
				//inserting record
				var toInsert = "贵州全省公共電視は移転";
				Jaxer.DB.execute("INSERT INTO " + sTable + " (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM " + sTable +
					" WHERE value0='" + toInsert + "'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable(sTable);
            }
            
            function testInsertUnicodeStringWithoutParameter()
            {			
				//creating DB table
				var sTable = "testUnicodeStringInsertWithoutParamTable"
            	initTable(sTable, "VARCHAR(40) character set utf8");
				
				//inserting record
				var toInsert = "贵州全省公共電視は移転";
				Jaxer.DB.execute("INSERT INTO " + sTable + " (value0) VALUES ('" + toInsert + "')");
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM " + sTable +
					" WHERE value0='" + toInsert + "'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable(sTable);
            }
            
            function testInsertUnicodeStringText()
            {			
				//creating DB table
				var sTable = "testUnicodeStringTEXTInsertTable";
            	initTable(sTable, "TEXT character set utf8");
				
				//inserting record
				var toInsert = "贵州全省公共電視は移転";
				Jaxer.DB.execute("INSERT INTO " + sTable + " (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM " + sTable +
					" WHERE value0='" + toInsert + "'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable(sTable);
            }
            
            function testInsertUnicodeStringTextWithoutParameter()
            {			
				//creating DB table
				var sTable = "testUnicodeStringTEXTInsertWithoutParamTable"
            	initTable(sTable, "TEXT character set utf8");
				
				//inserting record
				var toInsert = "贵州全省公共電視は移転";
				Jaxer.DB.execute("INSERT INTO " + sTable + " (value0) VALUES ('" + toInsert + "')");
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM " + sTable +
					" WHERE value0='" + toInsert + "'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable(sTable);
            }
		            
			function testInsertIntegerToTEXT()
			{			
				//creating DB table
				initTable("testInsertIntegerToTEXTTable", "TEXT");
				
				//inserting record
				var toInsert = 12;
				Jaxer.DB.execute("INSERT INTO testInsertIntegerToTEXTTable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testInsertIntegerToTEXTTable " +
					"WHERE value0=12").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testInsertIntegerToTEXTTable");
			}
			
			function testInsertIntegerToINTEGER()
			{			
				//creating DB table
				initTable("testInsertIntegerToINTEGERTable", "INTEGER");
			
				//inserting record
				var toInsert = 12;
				Jaxer.DB.execute("INSERT INTO testInsertIntegerToINTEGERTable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testInsertIntegerToINTEGERTable " +
					"WHERE value0='12'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testInsertIntegerToINTEGERTable");
			}
			
			function testInsertIntegerToSMALLINT()
			{			
				//creating DB table
				initTable("testInsertIntegerToSMALLINTTable", "SMALLINT");
			
				//inserting record
				var toInsert = 12;
				Jaxer.DB.execute("INSERT INTO testInsertIntegerToSMALLINTTable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testInsertIntegerToSMALLINTTable " +
					"WHERE value0='12'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testInsertIntegerToSMALLINTTable");
			}
			
			function testInsertIntegerToMEDIUMINT()
			{			
				//creating DB table
				initTable("testInsertIntegerToMEDIUMINTTable", "MEDIUMINT");
			
				//inserting record
				var toInsert = 12;
				Jaxer.DB.execute("INSERT INTO testInsertIntegerToMEDIUMINTTable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testInsertIntegerToMEDIUMINTTable " +
					"WHERE value0='12'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testInsertIntegerToMEDIUMINTTable");
			}
			
			function testInsertIntegerToBIGINT()
			{			
				//creating DB table
				initTable("testInsertIntegerToBIGINTTable", "BIGINT");
			
				//inserting record
				var toInsert = 12;
				Jaxer.DB.execute("INSERT INTO testInsertIntegerToBIGINTTable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testInsertIntegerToBIGINTTable " +
					"WHERE value0='12'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testInsertIntegerToBIGINTTable");
			}
			
			function testInsertIntegerToINTEGER()
			{			
				//creating DB table
				initTable("testInsertIntegerToINTEGERTable", "INTEGER");
			
				//inserting record
				var toInsert = 12;
				Jaxer.DB.execute("INSERT INTO testInsertIntegerToINTEGERTable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testInsertIntegerToINTEGERTable " +
					"WHERE value0='12'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testInsertIntegerToINTEGERTable");
			}
			
			function testInsertIntegerToUNSIGNED()
			{			
				//creating DB table
				initTable("testInsertIntegerToUNSIGNEDTable", "INT UNSIGNED");
			
				//inserting record
				var toInsert = 12;
				Jaxer.DB.execute("INSERT INTO testInsertIntegerToUNSIGNEDTable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testInsertIntegerToUNSIGNEDTable " +
					"WHERE value0='12'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testInsertIntegerToUNSIGNEDTable");
			}
			
			function testInsertIntegerToDOUBLE()
			{			
				//creating DB table
				initTable("testInsertINTEGERtoDOUBLETable", "DOUBLE");
			
				//inserting record
				var toInsert = 12;
				Jaxer.DB.execute("INSERT INTO testInsertINTEGERtoDOUBLETable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testInsertINTEGERtoDOUBLETable " +
					"WHERE value0='12'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testInsertINTEGERtoDOUBLETable");
			}
			
			// Not something we really need to test for:
//			function testInsertIntegerToBLOB()
//			{			
//				//creating DB table
//				initTable("testInsertIntegerToBLOBTable", "BLOB");
//			
//				//inserting record
//				var toInsert = 12;
//				Jaxer.DB.execute("INSERT INTO testInsertIntegerToBLOBTable (value0) VALUES (?)",[toInsert]);
//				
//				//checking that the value is written to the table
//				result = 
//					Jaxer.DB.execute("SELECT count(*) as c FROM testInsertIntegerToBLOBTable").singleResult;
//				assertTrue(result == 1, "We should have a record containing inserted value");
//				
//				//dropping the table
//				dropTable("testInsertIntegerToBLOBTable");
//			}
			
			function testInsertFloatToTEXT()
			{			
				//creating DB table
				initTable("testInsertFloatToTEXTTable", "TEXT");
				
				//inserting record
				var toInsert = 18.5;
				Jaxer.DB.execute("INSERT INTO testInsertFloatToTEXTTable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testInsertFloatToTEXTTable " +
					"WHERE value0=18.5").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testInsertFloatToTEXTTable");
			}
			
			function testInsertFloatToINTEGER()
			{			
				//creating DB table
				initTable("testInsertFloatToINTEGERTable", "INTEGER");
			
				//inserting record
				var toInsert = 18.4;
				Jaxer.DB.execute("INSERT INTO testInsertFloatToINTEGERTable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testInsertFloatToINTEGERTable " +
					"WHERE value0=18").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testInsertFloatToINTEGERTable");
			}
			
			function testInsertFloatToDOUBLE()
			{			
				//creating DB table
				initTable("testInsertINTEGERtoDOUBLETable", "DOUBLE");
			
				//inserting record
				var toInsert = 18.5;
				Jaxer.DB.execute("INSERT INTO testInsertINTEGERtoDOUBLETable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testInsertINTEGERtoDOUBLETable " +
					"WHERE value0='18.5'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testInsertINTEGERtoDOUBLETable");
			}
			
			// Not something we really need to test for:
//			function testInsertFloatToBLOB()
//			{			
//				//creating DB table
//				initTable("testInsertFloatToBLOBTable", "BLOB");
//			
//				//inserting record
//				var toInsert = 18.5;
//				Jaxer.DB.execute("INSERT INTO testInsertFloatToBLOBTable (value0) VALUES (?)",[toInsert]);
//				
//				//checking that the value is written to the table
//				result = 
//					Jaxer.DB.execute("SELECT count(*) as c FROM testInsertFloatToBLOBTable").singleResult;
//				assertTrue(result == 1, "We should have a record containing inserted value");
//				
//				//dropping the table
//				dropTable("testInsertFloatToBLOBTable");
//			}
			
			function testInsertBooleanToTEXT()
			{			
				//creating DB table
				initTable("testInsertBooleanToTEXTTable", "TEXT");
				
				//inserting record
				var toInsert = true;
				Jaxer.DB.execute("INSERT INTO testInsertBooleanToTEXTTable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testInsertBooleanToTEXTTable " +
					"WHERE value0=1").singleResult;
					
					
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testInsertBooleanToTEXTTable");
			}
			
			function testInsertBooleanToBOOLEAN()
			{			
				//creating DB table
				initTable("testInsertBooleanToBOOLEANTable", "BOOLEAN");
				
				//inserting record
				var toInsert = true;
				Jaxer.DB.execute("INSERT INTO testInsertBooleanToBOOLEANTable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testInsertBooleanToBOOLEANTable " +
					"WHERE value0='1'").singleResult;
					
					
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testInsertBooleanToBOOLEANTable");
			}
			
			function testInsertBooleanToINTEGER()
			{			
				//creating DB table
				initTable("testInsertBooleanToINTEGERTable", "INTEGER");
			
				//inserting record
				var toInsert = true;
				Jaxer.DB.execute("INSERT INTO testInsertBooleanToINTEGERTable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testInsertBooleanToINTEGERTable " +
					"WHERE value0='1'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testInsertBooleanToINTEGERTable");
			}
			
			function testInsertBooleanToDOUBLE()
			{			
				//creating DB table
				initTable("testInsertINTEGERtoDOUBLETable", "DOUBLE");
			
				//inserting record
				var toInsert = true;
				Jaxer.DB.execute("INSERT INTO testInsertINTEGERtoDOUBLETable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testInsertINTEGERtoDOUBLETable " +
					"WHERE value0='1.0'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testInsertINTEGERtoDOUBLETable");
			}
			
			function testInsertBooleanToBLOB()
			{			
				//creating DB table
				initTable("testInsertBooleanToBLOBTable", "BLOB");
			
				//inserting record
				var toInsert = true;
				Jaxer.DB.execute("INSERT INTO testInsertBooleanToBLOBTable (value0) VALUES (?)",[toInsert]);
				
				//checking that the value is written to the table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testInsertBooleanToBLOBTable").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testInsertBooleanToBLOBTable");
			}
		
			function testExtractStringFromTEXT()
			{			
				//creating DB table
				initTable("testStringFromTEXTExtractTable", "TEXT");
				
				//inserting record
				Jaxer.DB.execute("INSERT INTO testStringFromTEXTExtractTable (value0) VALUES ('Test string')");
				
				//checking the value that has been written to that table
				resultSet = Jaxer.DB.execute("SELECT value0 FROM testStringFromTEXTExtractTable");
				assertTrue(resultSet.hasData, "We should have some data");
				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
				assertEquals(resultSet.rows[0].value0, 'Test string', "Stored value should be the same as initial one");
				
				//dropping the table
				dropTable("testStringFromTEXTExtractTable");
			}
			
			function testExtractStringFromINTEGER()
			{			
				//creating DB table
				initTable("testStringFromINTEGERExtractTable", "INTEGER");
				
				//inserting record
				Jaxer.DB.execute("INSERT INTO testStringFromINTEGERExtractTable (value0) VALUES ('12')");
				
				//checking the value that has been written to that table
				resultSet = Jaxer.DB.execute("SELECT value0 FROM testStringFromINTEGERExtractTable");
				assertTrue(resultSet.hasData, "We should have some data");
				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
				assertEquals(resultSet.rows[0].value0, "12", "Stored value should be the same as initial one");
				
				//dropping the table
				dropTable("testStringFromINTEGERExtractTable");
			}
			
			function testExtractStringFromDOUBLE()
			{			
				//creating DB table
				initTable("testStringFromDOUBLEExtractTable", "DOUBLE");
			
				//inserting record
				Jaxer.DB.execute("INSERT INTO testStringFromDOUBLEExtractTable (value0) VALUES (17.5)");
				
				//checking the value that has been written to that table
				resultSet = Jaxer.DB.execute("SELECT value0 FROM testStringFromDOUBLEExtractTable");
				assertTrue(resultSet.hasData, "We should have some data");
				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
				assertEquals(resultSet.rows[0].value0, "17.5", "Stored value should be the same as initial one");
				
				//dropping the table
				dropTable("testStringFromDOUBLEExtractTable");
			}
			
			// Not something we really need to test for:
//			function testExtractStringFromBLOB()
//			{			
//				//creating DB table
//				initTable("testStringFromBLOBExtractTable", "BLOB");
//			
//				//inserting record
//				Jaxer.DB.execute("INSERT INTO testStringFromBLOBExtractTable (value0) VALUES ('Test string')");
//				
//				//checking the value that has been written to that table
//				resultSet = Jaxer.DB.execute("SELECT value0 FROM testStringFromBLOBExtractTable");
//				assertTrue(resultSet.hasData, "We should have some data");
//				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
//				assertEquals(resultSet.rows[0].value0, "Test string", "Stored value should be the same as initial one");
//				
//				//dropping the table
//				dropTable("testStringFromBLOBExtractTable");
//			}
			
			function testExtractIntegerFromTEXT()
			{			
				//creating DB table
				initTable("testExtractIntegerFromTEXTTable", "TEXT");
				
				//inserting record
				Jaxer.DB.execute("INSERT INTO testExtractIntegerFromTEXTTable (value0) VALUES ('12')");
				
				//checking the value that has been written to that table
				resultSet = Jaxer.DB.execute("SELECT value0 FROM testExtractIntegerFromTEXTTable");
				assertTrue(resultSet.hasData, "We should have some data");
				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
				assertEquals(resultSet.rows[0].value0, 12, "Stored value should be the same as initial one");
				
				//dropping the table
				dropTable("testExtractIntegerFromTEXTTable");
			}
			
			function testExtractIntegerFromINTEGER()
			{			
				//creating DB table
				initTable("testExtractIntegerFromINTEGERTable", "INTEGER");
			
				//inserting record
				Jaxer.DB.execute("INSERT INTO testExtractIntegerFromINTEGERTable (value0) VALUES ('12')");
				
				//checking the value that has been written to that table
				resultSet = Jaxer.DB.execute("SELECT value0 FROM testExtractIntegerFromINTEGERTable");
				assertTrue(resultSet.hasData, "We should have some data");
				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
				assertEquals(resultSet.rows[0].value0, 12, "Stored value should be the same as initial one");
				
				//dropping the table
				dropTable("testExtractIntegerFromINTEGERTable");
			}
			
			function testExtractIntegerFromDOUBLE()
			{			
				//creating DB table
				initTable("testExtractINTEGERtoDOUBLETable", "DOUBLE");
			
				//inserting record
				Jaxer.DB.execute("INSERT INTO testExtractINTEGERtoDOUBLETable (value0) VALUES ('12')");
				
				//checking the value that has been written to that table
				resultSet = Jaxer.DB.execute("SELECT value0 FROM testExtractINTEGERtoDOUBLETable");
				assertTrue(resultSet.hasData, "We should have some data");
				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
				assertEquals(resultSet.rows[0].value0, 12, "Stored value should be the same as initial one");
				
				//dropping the table
				dropTable("testExtractINTEGERtoDOUBLETable");
			}
			
			// Not something we really need to test for:
//			function testExtractIntegerFromBLOB()
//			{			
//				//creating DB table
//				initTable("testExtractIntegerFromBLOBTable", "BLOB");
//			
//				//inserting record
//				Jaxer.DB.execute("INSERT INTO testExtractIntegerFromBLOBTable (value0) VALUES ('12')");
//				
//				//checking the value that has been written to that table
//				resultSet = Jaxer.DB.execute("SELECT value0 FROM testExtractIntegerFromBLOBTable");
//				assertTrue(resultSet.hasData, "We should have some data");
//				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
//				assertEquals(resultSet.rows[0].value0, 12, "Stored value should be the same as initial one");
//				
//				//dropping the table
//				dropTable("testExtractIntegerFromBLOBTable");
//			}
			
			function testExtractFloatFromTEXT()
			{			
				//creating DB table
				initTable("testExtractFloatFromTEXTTable", "TEXT");
				
				//inserting record
				Jaxer.DB.execute("INSERT INTO testExtractFloatFromTEXTTable (value0) VALUES ('18.5')");
				
				//checking the value that has been written to that table
				resultSet = Jaxer.DB.execute("SELECT value0 FROM testExtractFloatFromTEXTTable");
				assertTrue(resultSet.hasData, "We should have some data");
				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
				assertEquals(resultSet.rows[0].value0, 18.5, "Stored value should be the same as initial one");
				
				//dropping the table
				dropTable("testExtractFloatFromTEXTTable");
			}
			
			function testExtractFloatFromINTEGER()
			{			
				//creating DB table
				initTable("testExtractFloatFromINTEGERTable", "INTEGER");
			
				//inserting record
				Jaxer.DB.execute("INSERT INTO testExtractFloatFromINTEGERTable (value0) VALUES ('18.6')");
				
				//checking the value that has been written to that table
				resultSet = Jaxer.DB.execute("SELECT value0 FROM testExtractFloatFromINTEGERTable");
				assertTrue(resultSet.hasData, "We should have some data");
				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
				assertEquals(resultSet.rows[0].value0, 19, "Stored value should be the same as initial one");
				
				//dropping the table
				dropTable("testExtractFloatFromINTEGERTable");
			}
			
			function testExtractFloatFromDOUBLE()
			{			
				//creating DB table
				initTable("testExtractINTEGERtoDOUBLETable", "DOUBLE");
			
				//inserting record
				Jaxer.DB.execute("INSERT INTO testExtractINTEGERtoDOUBLETable (value0) VALUES (18.5)");
				
				//checking the value that has been written to that table
				resultSet = Jaxer.DB.execute("SELECT value0 FROM testExtractINTEGERtoDOUBLETable");
				assertTrue(resultSet.hasData, "We should have some data");
				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
				assertEquals(resultSet.rows[0].value0, 18.5, "Stored value should be the same as initial one");
				
				//dropping the table
				dropTable("testExtractINTEGERtoDOUBLETable");
			}
			
			// Not something we really need to test for:
//			function testExtractFloatFromBLOB()
//			{			
//				//creating DB table
//				initTable("testExtractFloatFromBLOBTable", "BLOB");
//			
//				//inserting record
//				Jaxer.DB.execute("INSERT INTO testExtractFloatFromBLOBTable (value0) VALUES ('18.5')");
//				
//				//checking the value that has been written to that table
//				resultSet = Jaxer.DB.execute("SELECT value0 FROM testExtractFloatFromBLOBTable");
//				assertTrue(resultSet.hasData, "We should have some data");
//				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
//				assertEquals(resultSet.rows[0].value0, 18.5, "Stored value should be the same as initial one");
//				
//				//dropping the table
//				dropTable("testExtractFloatFromBLOBTable");
//			}
			
			function testExtractBooleanFromTEXT()
			{			
				//creating DB table
				initTable("testExtractBooleanFromTEXTTable", "TEXT");
				
				//inserting record
				Jaxer.DB.execute("INSERT INTO testExtractBooleanFromTEXTTable (value0) VALUES ('1')");
				
				//checking the value that has been written to that table
				resultSet = Jaxer.DB.execute("SELECT value0 FROM testExtractBooleanFromTEXTTable");
				assertTrue(resultSet.hasData, "We should have some data");
				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
				assertEquals(resultSet.rows[0].value0, true, "Stored value should be the same as initial one");
				
				//dropping the table
				dropTable("testExtractBooleanFromTEXTTable");
			}
			
			
			function testExtractBooleanFromBOOLEAN()
			{			
				//creating DB table
				initTable("testExtractBooleanFromBOOLEANTable", "BOOLEAN");
				
				//inserting record
				Jaxer.DB.execute("INSERT INTO testExtractBooleanFromBOOLEANTable (value0) VALUES (true)");
				
				//checking the value that has been written to that table
				resultSet = Jaxer.DB.execute("SELECT value0 FROM testExtractBooleanFromBOOLEANTable");
				assertTrue(resultSet.hasData, "We should have some data");
				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
				assertEquals(resultSet.rows[0].value0, true, "Stored value should be the same as initial one");
				
				//dropping the table
				dropTable("testExtractBooleanFromBOOLEANTable");
			}
			
			function testExtractBooleanFromINTEGER()
			{			
				//creating DB table
				initTable("testExtractBooleanFromINTEGERTable", "INTEGER");
			
				//inserting record
				Jaxer.DB.execute("INSERT INTO testExtractBooleanFromINTEGERTable (value0) VALUES ('1')");
				
				//checking the value that has been written to that table
				resultSet = Jaxer.DB.execute("SELECT value0 FROM testExtractBooleanFromINTEGERTable");
				assertTrue(resultSet.hasData, "We should have some data");
				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
				assertEquals(resultSet.rows[0].value0, true, "Stored value should be the same as initial one");
				
				//dropping the table
				dropTable("testExtractBooleanFromINTEGERTable");
			}
			
			function testExtractBooleanFromDOUBLE()
			{			
				//creating DB table
				initTable("testExtractINTEGERtoDOUBLETable", "DOUBLE");
			
				//inserting record
				Jaxer.DB.execute("INSERT INTO testExtractINTEGERtoDOUBLETable (value0) VALUES ('1')");
				
				//checking the value that has been written to that table
				resultSet = Jaxer.DB.execute("SELECT value0 FROM testExtractINTEGERtoDOUBLETable");
				assertTrue(resultSet.hasData, "We should have some data");
				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
				assertEquals(resultSet.rows[0].value0, true, "Stored value should be the same as initial one");
				
				//dropping the table
				dropTable("testExtractINTEGERtoDOUBLETable");
			}
			
			// Not something we really need to test for:
//			function testExtractBooleanFromBLOB()
//			{			
//				//creating DB table
//				initTable("testExtractBooleanFromBLOBTable", "BLOB");
//			
//				//inserting record
//				Jaxer.DB.execute("INSERT INTO testExtractBooleanFromBLOBTable (value0) VALUES ('1')");
//				
//				//checking the value that has been written to that table
//				resultSet = Jaxer.DB.execute("SELECT value0 FROM testExtractBooleanFromBLOBTable");
//				assertTrue(resultSet.hasData, "We should have some data");
//				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
//				assertEquals(resultSet.rows[0].value0, true, "Stored value should be the same as initial one");
//				
//				//dropping the table
//				dropTable("testExtractBooleanFromBLOBTable");
//			}
			
			function testInsertExtractDateToDATETIME()
			{			
				//creating DB table
				initTable("testInsertExtractDateToDATETIMETable", "DATETIME");
			
				//inserting record
				var toInsert = createTestDate();
				Jaxer.DB.execute("INSERT INTO testInsertExtractDateToDATETIMETable (value0) VALUES (?)",[toInsert]);
				
				//checking that the value is written to the table
				resultSet = Jaxer.DB.execute("SELECT value0 FROM testInsertExtractDateToDATETIMETable");
				assertTrue(resultSet.hasData, "We should have some data");
				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
				assertDatesEqual(resultSet.rows[0].value0, toInsert, "Stored value should be the same as initial one");
				//dropping the table
				dropTable("testInsertExtractDateToDATETIMETable");
			}
			
			function testInsertExtractDateToDATETIME2()
			{			
				//creating DB table
				initTable("testInsertExtractDateToDATETIMETable", "DATETIME");
			
				//inserting record
				var toInsert = createTestDate();
				Jaxer.DB.execute("INSERT INTO testInsertExtractDateToDATETIMETable (value0) VALUES (?)",[toInsert]);
				
				//checking that the value is written to the table
				resultSet = Jaxer.DB.execute("SELECT value0 FROM testInsertExtractDateToDATETIMETable WHERE value0 <> ?", -1);
				assertTrue(resultSet.hasData, "We should have some data");
				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
				assertDatesEqual(resultSet.rows[0].value0, toInsert, "Stored value should be the same as initial one");
				//dropping the table
				dropTable("testInsertExtractDateToDATETIMETable");
			}
			
			function testInsertExtractDateToDATE()
			{			
				//creating DB table
				initTable("testInsertExtractDateToDATETable", "DATE");
			
				//inserting record
				var toInsert = createTestDate();
				Jaxer.DB.execute("INSERT INTO testInsertExtractDateToDATETable (value0) VALUES (?)",[toInsert]);
				
				//checking that the value is written to the table
				resultSet = Jaxer.DB.execute("SELECT value0 FROM testInsertExtractDateToDATETable");
				assertTrue(resultSet.hasData, "We should have some data");
				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
				var returnedDate = new Date(resultSet.rows[0].value0);
				
				assertTrue(returnedDate.getYear() == toInsert.getYear(), "Stored year value should be the same as initial one");
				assertTrue(returnedDate.getMonth() == toInsert.getMonth(), "Stored month value should be the same as initial one");
				assertTrue(returnedDate.getDate() == toInsert.getDate(), "Stored day of month value should be the same as initial one");
				//dropping the table
				dropTable("testInsertExtractDateToDATETable");
			}
			
			function testInsertExtractDateToTIME()
			{			
				//creating DB table
				initTable("testInsertExtractDateToTIMETable", "TIME");
			
				//inserting record
				var toInsert = createTestDate();
				Jaxer.DB.execute("INSERT INTO testInsertExtractDateToTIMETable (value0) VALUES (?)",[toInsert]);
				
				//checking that the value is written to the table
				resultSet = Jaxer.DB.execute("SELECT value0 FROM testInsertExtractDateToTIMETable");
				assertTrue(resultSet.hasData, "We should have some data");
				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
				assertTimesOnlyEqual(resultSet.rows[0].value0, toInsert, "Stored value should be the same as initial one");
				//dropping the table
				dropTable("testInsertExtractDateToTIMETable");
			}
			
			function testInsertExtractDateToDATETIMENoParameters()
			{			
				//creating DB table
				initTable("testInsertExtractDateToDATETIMETable", "DATETIME");
			
				//inserting record
				var toInsert = createTestDate();
				Jaxer.DB.execute("INSERT INTO testInsertExtractDateToDATETIMETable (value0) VALUES (?)",[toInsert]);
				
				//checking that the value is written to the table
				resultSet = Jaxer.DB.execute("SELECT value0 FROM testInsertExtractDateToDATETIMETable");
				assertTrue(resultSet.hasData, "We should have some data");
				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
				assertDatesEqual(resultSet.rows[0].value0, toInsert, "Stored value should be the same as initial one");
				//dropping the table
				dropTable("testInsertExtractDateToDATETIMETable");
			}
			
			function testInsertExtractDateToDATENoParameters()
			{			
				//creating DB table
				initTable("testInsertExtractDateToDATETable", "DATE");
			
				//inserting record
				var toInsert = createTestDate();
				Jaxer.DB.execute("INSERT INTO testInsertExtractDateToDATETable (value0) VALUES (?)",[toInsert]);
				
				//checking that the value is written to the table
				resultSet = Jaxer.DB.execute("SELECT value0 FROM testInsertExtractDateToDATETable");
				assertTrue(resultSet.hasData, "We should have some data");
				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
				
				var returnedDate = resultSet.rows[0].value0;
				
				assertEquals(returnedDate.getYear(), toInsert.getYear(), "Stored year value should be the same as initial one");
				assertEquals(returnedDate.getMonth(), toInsert.getMonth(), "Stored month value should be the same as initial one");
				assertEquals(returnedDate.getDate(), toInsert.getDate(), "Stored day of month value should be the same as initial one");
				//dropping the table
				dropTable("testInsertExtractDateToDATETable");
			}
			
			function testInsertExtractDateToTIMENoParameters()
			{			
				//creating DB table
				initTable("testInsertExtractDateToTIMETable", "TIME");
			
				//inserting record
				var toInsert = createTestDate();
				Jaxer.DB.execute("INSERT INTO testInsertExtractDateToTIMETable (value0) VALUES (?)",[toInsert]);
				
				//checking that the value is written to the table
				resultSet = Jaxer.DB.execute("SELECT value0 FROM testInsertExtractDateToTIMETable");
				assertTrue(resultSet.hasData, "We should have some data");
				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
				assertTimesOnlyEqual(resultSet.rows[0].value0, toInsert, "Stored value should be the same as initial one");
				//dropping the table
				dropTable("testInsertExtractDateToTIMETable");
			}
			
			// Not something we really need to test for:
//			function testInsertExtractStringToBLOB()
//			{			
//				//creating DB table
//				initTable("testStringToBLOBInsertExtractTable", "BLOB");
//			
//				//inserting record
//				var toInsert = "Test string";
//				Jaxer.DB.execute("INSERT INTO testStringToBLOBInsertExtractTable (value0) VALUES (?)",[toInsert]);
//				
//				//checking the value that has been written to that table
//				resultSet = Jaxer.DB.execute("SELECT value0 FROM testStringToBLOBInsertExtractTable");
//				assertTrue(resultSet.hasData, "We should have some data");
//				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
//				assertEquals(resultSet.rows[0].value0, toInsert, "Stored value should be the same as initial one");
//				
//				//dropping the table
//				dropTable("testStringToBLOBInsertExtractTable");
//			}
			
			// Not something we really need to test for:
//			function testInsertExtractIntegerToBLOB()
//			{			
//				//creating DB table
//				initTable("testInsertExtractIntegerToBLOBTable", "BLOB");
//			
//				//inserting record
//				var toInsert = 12;
//				Jaxer.DB.execute("INSERT INTO testInsertExtractIntegerToBLOBTable (value0) VALUES (?)",[toInsert]);
//				
//				//checking the value that has been written to that table
//				resultSet = Jaxer.DB.execute("SELECT value0 FROM testInsertExtractIntegerToBLOBTable");
//				assertTrue(resultSet.hasData, "We should have some data");
//				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
//				assertEquals(resultSet.rows[0].value0, toInsert, "Stored value should be the same as initial one");
//				
//				//dropping the table
//				dropTable("testInsertExtractIntegerToBLOBTable");
//			}
			
			// Not something we really need to test for:
//			function testInsertExtractFloatToBLOB()
//			{			
//				//creating DB table
//				initTable("testInsertExtractFloatToBLOBTable", "BLOB");
//			
//				//inserting record
//				var toInsert = 18.5;
//				Jaxer.DB.execute("INSERT INTO testInsertExtractFloatToBLOBTable (value0) VALUES (?)",[toInsert]);
//				
//				//checking the value that has been written to that table
//				resultSet = Jaxer.DB.execute("SELECT value0 FROM testInsertExtractFloatToBLOBTable");
//				assertTrue(resultSet.hasData, "We should have some data");
//				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
//				assertEquals(resultSet.rows[0].value0, toInsert, "Stored value should be the same as initial one");
//				
//				//dropping the table
//				dropTable("testInsertExtractFloatToBLOBTable");
//			}
			
			// Not something we really need to test for:
//			function testInsertExtractBooleanToBLOB()
//			{			
//				//creating DB table
//				initTable("testInsertExtractBooleanToBLOBTable", "BLOB");
//			
//				//inserting record
//				var toInsert = true;
//				Jaxer.DB.execute("INSERT INTO testInsertExtractBooleanToBLOBTable (value0) VALUES (?)",[toInsert]);
//				
//				//checking the value that has been written to that table
//				resultSet = Jaxer.DB.execute("SELECT value0 FROM testInsertExtractBooleanToBLOBTable");
//				assertTrue(resultSet.hasData, "We should have some data");
//				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
//				assertEquals(resultSet.rows[0].value0, toInsert, "Stored value should be the same as initial one");
//				
//				//dropping the table
//				dropTable("testInsertExtractBooleanToBLOBTable");
//			}
			
			function testInsertExtractDateToTEXT() // TODO remove Date.parse() protection
			{			
				//creating DB table
				initTable("testInsertExtractDateToTEXTTable", "TEXT");
			
				//inserting record
				var toInsert = Date.parse(createTestDate());
				Jaxer.DB.execute("INSERT INTO testInsertExtractDateToTEXTTable (value0) VALUES (?)",[toInsert]);
				
				//checking the value that has been written to that table
				resultSet = Jaxer.DB.execute("SELECT value0 FROM testInsertExtractDateToTEXTTable");
				assertTrue(resultSet.hasData, "We should have some data");
				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
				
				assertTrue(resultSet.rows[0].value0 == toInsert, "Stored value should be the same as initial one");
				//dropping the table
				dropTable("testInsertExtractDateToTEXTTable");
			}
			
			// Not something we really need to test for:
//			function testInsertExtractDateToBLOB() // TODO remove Date.parse() protection
//			{			
//				//creating DB table
//				initTable("testInsertExtractDateToBLOBTable", "BLOB");
//			
//				//inserting record
//				var toInsert = Date.parse(createTestDate());
//				Jaxer.DB.execute("INSERT INTO testInsertExtractDateToBLOBTable (value0) VALUES (?)",[toInsert]);
//				
//				//checking the value that has been written to that table
//				resultSet = Jaxer.DB.execute("SELECT value0 FROM testInsertExtractDateToBLOBTable");
//				assertTrue(resultSet.hasData, "We should have some data");
//				assertTrue(resultSet.rows.length == 1, "We should have exactly one record, but have " + resultSet.rows.length);
//				
//				assertTrue(resultSet.rows[0].value0 == toInsert, "Stored value should be the same as initial one");
//				
//				//dropping the table
//				dropTable("testInsertExtractDateToBLOBTable");
//			}
		
//			
//			function testInsertNonNumericStringToINTEGER()
//			{			
//				//creating DB table
//				initTable("testInsertNonNumericStringToINTEGERTable", "INTEGER");
//				
//				//inserting record
//				var toInsert = "aa";
//		
//				Jaxer.DB.execute("INSERT INTO testInsertNonNumericStringToINTEGERTable (value0) VALUES (?)",[toInsert]);
//				result = 
//					Jaxer.DB.execute("SELECT count(*) as c FROM testInsertNonNumericStringToINTEGERTable " +
//					"WHERE value0=0").singleResult;
//				assertTrue(result == 1, "We should have a record containing inserted value");
//				
//				//dropping the table
//				dropTable("testInsertNonNumericStringToINTEGERTable");
//			}
//			
//			function testInsertNonNumericStringToDOUBLE()
//			{			
//				//creating DB table
//				initTable("testInsertNonNumericStringToDOUBLETable", "DOUBLE");
//				
//				//inserting record
//				var toInsert = "aa";
//				
//				Jaxer.DB.execute("INSERT INTO testInsertNonNumericStringToDOUBLETable (value0) VALUES (?)",[toInsert]);
//				
//				result = 
//					Jaxer.DB.execute("SELECT count(*) as c FROM testInsertNonNumericStringToDOUBLETable " +
//					"WHERE value0=0").singleResult;
//				assertTrue(result == 1, "We should have a record containing inserted value");
//				
//				//dropping the table
//				dropTable("testInsertNonNumericStringToDOUBLETable");
//			}
			
			function testInsertExtractDateToINTEGER()
			{			
				//creating DB table
				initTable("testInsertExtractDateToINTEGERTable", "INTEGER");
			
				//inserting record as milliseconds downsized to fit in an interger filed this means we lose some precision
				var toInsert = Date.parse(createTestDate())/1000;
				Jaxer.DB.execute("INSERT INTO testInsertExtractDateToINTEGERTable (value0) VALUES (?)",[toInsert]);
				
				result = Jaxer.DB.execute("SELECT value0 as c FROM testInsertExtractDateToINTEGERTable WHERE value0 is not null").singleResult;
				
				assertTrue(result == toInsert, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testInsertExtractDateToINTEGERTable");
			}
			
			function testInsertExtractDateToDOUBLE()
			{			
				//creating DB table
				initTable("testInsertExtractDateToDOUBLETable", "DOUBLE");
			
				//inserting record for date a milliseconds since epoch
				var toInsert = Date.parse(createTestDate());
								
				Jaxer.DB.execute("INSERT INTO testInsertExtractDateToDOUBLETable (value0) VALUES (?)",[toInsert]);
				
				result = Jaxer.DB.execute("SELECT value0 as c FROM testInsertExtractDateToDOUBLETable WHERE value0 is not null").singleResult;
					
				assertTrue(result == toInsert, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testInsertExtractDateToDOUBLETable");
			}
			
			function testResultSetColumnIndex()
			{
				//creating and clearing the table
				var createTestDBtable = 
				<SQL>
					CREATE TABLE IF NOT EXISTS testResultSetColumnIndexTable (
						column1 TEXT,
						column2 TEXT,
						column3 TEXT
					);
				</SQL>			
				Jaxer.DB.execute(createTestDBtable);
				
				var clearTestDBTable = "DELETE FROM testResultSetColumnIndexTable";
				Jaxer.DB.execute(clearTestDBTable);	
				
				//inserting record
				Jaxer.DB.execute("INSERT INTO testResultSetColumnIndexTable " +
					"(column1, column2, column3) VALUES ('text1', 'text2', 'text3')");
				
				//reading te table	
				resultSet = Jaxer.DB.execute("SELECT * FROM testResultSetColumnIndexTable");
				assertEquals(resultSet.indexOfColumn("column2"), 1, "Expecting 2 as index column");
				//dropping the table	
				dropTable("testResultSetColumnIndexTable");
			}
			
			function testResultSetExtractColumns()
			{
				//creating and clearing the table
				var createTestDBtable = 
				<SQL>
					CREATE TABLE IF NOT EXISTS testResultSetColumnIndexTable (
						column1 TEXT,
						column2 TEXT,
						column3 TEXT
					);
				</SQL>			
				Jaxer.DB.execute(createTestDBtable);
				
				var clearTestDBTable = "DELETE FROM testResultSetColumnIndexTable";
				Jaxer.DB.execute(clearTestDBTable);	
				
				//inserting record
				Jaxer.DB.execute("INSERT INTO testResultSetColumnIndexTable " +
					"(column1, column2, column3) VALUES ('text1', 'text2', 'text3')");
				
				//reading te table	
				resultSet = Jaxer.DB.execute("SELECT * FROM testResultSetColumnIndexTable");
				assertEquals(resultSet.columns[0], 'column1', "No column found");
				assertEquals(resultSet.columns[1], 'column2', "No column found");
				assertEquals(resultSet.columns[2], 'column3', "No column found");
				var cols = new Array();
				cols[0] = 'column1';
				cols[1] = 'column3';
				extractedSet = resultSet.extractColumns(cols);
				assertEquals(extractedSet[0].column1, 'text1', "No column found");
				assertEquals(extractedSet[0].column3, 'text3', "No column found");
				try
				{
					assertEquals(extractedSet[0].column2, 'text2', "No column found");
				}
				catch (err)
				{
					//dropping the table
					dropTable("testResultSetColumnIndexTable");
					return;
				}
				
				//dropping the table
				dropTable("testResultSetColumnIndexTable");
				throw("Should not reach this point");
			}
			
			function testAutoWrappingSingleParameterToArray()
			{			
				//creating DB table
				initTable("testStringToTEXTInsertTable", "TEXT");
				
				//inserting record
				var toInsert = "Test string";
				Jaxer.DB.execute("INSERT INTO testStringToTEXTInsertTable (value0) VALUES (?)",toInsert);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testStringToTEXTInsertTable " +
					"WHERE value0='Test string'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testStringToTEXTInsertTable");
			}
			
			function testAutoWrappingSingleParameterToArray2()
			{			
				//creating DB table
				initTable("testInsertINTEGERtoDOUBLETable", "DOUBLE");
			
				//inserting record
				var toInsert = 12;
				Jaxer.DB.execute("INSERT INTO testInsertINTEGERtoDOUBLETable (value0) VALUES (?)",toInsert);
				
				//checking the value that has been written to that table
				result = 
					Jaxer.DB.execute("SELECT count(*) as c FROM testInsertINTEGERtoDOUBLETable " +
					"WHERE value0='12'").singleResult;
				assertTrue(result == 1, "We should have a record containing inserted value");
				
				//dropping the table
				dropTable("testInsertINTEGERtoDOUBLETable");
			}
			
			function testWritingReadingBlob()
			{
				initTable('testWritingReadingBlobTable', ["BLOB", "INTEGER"]);
				var data = [12,43,190,67,23];
				Jaxer.DB.execute("INSERT INTO testWritingReadingBlobTable (value0, value1) VALUES (?, ?)", [data, 1]);
				var retrievedData = Jaxer.DB.execute("SELECT value0 FROM testWritingReadingBlobTable").singleResult;
				assertEquals(retrievedData.constructor, retrievedData.__parent__.Array, "Should have read back (using query, not prepared statement) an Array");
				assertEquals(String(retrievedData), String(data), "Should have read back (using query, not prepared statement) the same binary data written");
				var retrievedDataPrepared = Jaxer.DB.execute("SELECT value0 FROM testWritingReadingBlobTable WHERE value1 <> ?", -1).singleResult;
				assertEquals(retrievedDataPrepared.constructor, retrievedDataPrepared.__parent__.Array, "Should have read back (using prepared statement) an Array");
				assertEquals(String(retrievedDataPrepared), String(data), "Should have read back (using prepared statement) the same binary data written");
			}
			
			function testWritingReadingText()
			{
				initTable('testWritingReadingTextTable', ["TEXT", "INTEGER"]);
				var data = "The rain in Spain falls mainly in the plain";
				Jaxer.DB.execute("INSERT INTO testWritingReadingTextTable (value0, value1) VALUES (?, ?)", data, 1);
				var retrievedData = Jaxer.DB.execute("SELECT value0 FROM testWritingReadingTextTable").singleResult;
				assertEquals(typeof retrievedData, "string", "Should have read back (using query, not prepared statement) a string");
				assertEquals(String(retrievedData), String(data), "Should have read back (using query, not prepared statement) the same TEXT data written");
				var retrievedDataPrepared = Jaxer.DB.execute("SELECT value0 FROM testWritingReadingTextTable WHERE value1 <> ?", -1).singleResult;
				assertEquals(typeof retrievedDataPrepared, "string", "Should have read back (using prepared statement) a string");
				assertEquals(String(retrievedDataPrepared), String(data), "Should have read back (using prepared statement) the same TEXT data written");
			}
			
			function testBadNonPreparedStatement()
			{
				Jaxer.Log.info("The following is an intentional server-side non-prepared-statement database error");
				var err = null;
				try
				{
					var unlikelyTable = "TABLE_" + (new Date()).getTime();
					Jaxer.DB.execute("SELECT * FROM " + unlikelyTable)
				}
				catch (e) 
				{
					err = e;
				};
				assertNotUndefined(err, "'SELECT * FROM " + unlikelyTable + "' should have thrown an Exception but did not");
				assertEquals(err[Jaxer.DB.SQL_ERROR_CODE_PROPERTY], 1146, "The " + Jaxer.DB.SQL_ERROR_CODE_PROPERTY + " should have been set to the right value");
				assertNotUndefined(err[Jaxer.DB.SQL_ERROR_DESCRIPTION_PROPERTY], "The " + Jaxer.DB.SQL_ERROR_DESCRIPTION_PROPERTY + " should have been defined");
			}
			
			function testBadPreparedStatement()
			{
				Jaxer.Log.info("The following is an intentional server-side prepared-statement database error");
				var err = null;
				try
				{
					var unlikelyTable = "TABLE_" + (new Date()).getTime();
					Jaxer.DB.execute("CREATE TABLE " + unlikelyTable + " (c1 INTEGER NOT NULL)");
					Jaxer.DB.execute("INSERT INTO " + unlikelyTable + " (c1) VALUES (?)", null)
				}
				catch (e) 
				{
					err = e;
				}
				finally
				{
					try
					{
					Jaxer.DB.execute("DROP TABLE " + unlikelyTable);
					}
					catch (e)
					{
						// nothing to do
					}
				}
				assertNotUndefined(err, "Inserting null into a column marked as NOT NULL should have thrown an Exception but did not");
				assertEquals(err[Jaxer.DB.SQL_ERROR_CODE_PROPERTY], 1048, "The " + Jaxer.DB.SQL_ERROR_CODE_PROPERTY + " should have been set to the right value");
				assertNotUndefined(err[Jaxer.DB.SQL_ERROR_DESCRIPTION_PROPERTY], "The " + Jaxer.DB.SQL_ERROR_DESCRIPTION_PROPERTY + " should have been defined");
			}
			
			function testMapExecute()
			{
				initTable("testMapExecuteTable", ["INTEGER", "TEXT", "DATETIME"]);
				
				var results = Jaxer.DB.mapExecute("INSERT INTO testMapExecuteTable (value0, value1, value2) VALUES (?, ?, ?)",
					[[1, "test1", (new Date())], [2, "test2", (new Date())], [3, "test3", (new Date())], [3, "test3-2", (new Date())]]);
				assertEquals(results.length, 4, "mapExecute of INSERT should have returned 4 results");
				assertEquals(results[0], 1, "First result of mapExecute should have been 1");
				
				var resultSets = Jaxer.DB.mapExecute("SELECT * FROM testMapExecuteTable WHERE value0 = ?", [1, 2, 3]);
				assertEquals(resultSets.length, 3, "Should have found 3 resultSets");
				assertEquals(resultSets[1].columns.length, 3, "Should have found 3 columns in the second resultSet");
				assertEquals(resultSets[2].rows.length, 2, "Should have found 2 rows in the 3rd resultSet");
				assertEquals(resultSets[2].rows[1].value1, "test3-2", "Should have retrieved this value from the 3rd resultSet's second row in the second column");

				var resultSets2 = Jaxer.DB.mapExecute("SELECT * FROM testMapExecuteTable WHERE value0 = ? AND value1 = ?", [[1, "test1"], [3, "test3"], [3, "testX"]]);
				assertEquals(resultSets2.length, 3, "Should have found 3 resultSets");
				assertEquals(resultSets2[0].columns.length, 3, "Should have found 3 columns in the first resultSet");
				assertEquals(resultSets2[1].rows.length, 1, "Should have found 1 row in the 2nd resultSet");
				assertEquals(resultSets2[2].rows.length, 0, "Should have found no rows in the 3rd resultSet");
				assertEquals(resultSets2[0].rows[0].value0, 1, "Should have retrieved this value from the 1st resultSet's first row in the first column");
				
				var resultSet = Jaxer.DB.mapExecute("SELECT * FROM testMapExecuteTable WHERE value0 = ?", [[1], [3], [5]], {flatten: true});
				assertTrue(resultSet instanceof Jaxer.DB.ResultSet, "Should have come back with an object of type Jaxer.DB.ResultSet");
				assertEquals(resultSet.columns.length, 3, "Should have found 3 columns in the resultSet");
				assertEquals(resultSet.rows.length, 3, "Should have found 3 rows in the combined resultSet")
				assertEquals(resultSet.rows[0].value0, 1, "Should have retrieved this value from the resultSet's first row in the first column");
				assertEquals(resultSet.rows[1].value1, "test3", "Should have retrieved this value from the resultSet's second row in the second column");
				assertEquals(resultSet.rows[2].value1, "test3-2", "Should have retrieved this value from the resultSet's third row in the second column");
				
				//dropTable("testMapExecuteTable");
			}
				
		</script>
	</head>
	<body>
	</body>
</html>